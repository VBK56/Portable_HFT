<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Selected Projects Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 10px;
            background-color: white;
            color: #333;
        }
        
        h2 {
            margin-bottom: 15px;
            text-align: center;
            color: #333;
            font-size: 16px;
        }
        
        /* üéØ LANDSCAPE –§–û–†–ú–ê–¢ - –ö–†–£–ü–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px; /* –ö—Ä—É–ø–Ω–µ–µ —à—Ä–∏—Ñ—Ç –¥–ª—è landscape */
            table-layout: fixed;
            margin: 0 auto;
        }
        
        th, td {
            border: 1px solid #000;
            padding: 4px 6px; /* –ë–æ–ª—å—à–µ –æ—Ç—Å—Ç—É–ø—ã */
            vertical-align: middle;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        th {
            background-color: #f0f0f0;
            font-weight: bold;
            text-align: center;
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.2;
            font-size: 10px;
        }
        
        td {
            white-space: nowrap;
            line-height: 1.3;
        }
        
        tbody tr:nth-child(even) {
            background-color: #f8f8f8;
        }
        
        tbody tr:hover {
            background-color: #f0f0f0;
        }
        
        /* üéØ –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ï –®–ò–†–ò–ù–´ –î–õ–Ø LANDSCAPE */
        .col-name {
            width: 12%;
            text-align: left;
            font-weight: bold;
            white-space: normal;
            word-wrap: break-word;
        }
        
        .col-status {
            width: 7%;
            text-align: center;
            font-weight: 500;
        }
        
        .col-date {
            width: 9%;
            text-align: center;
            font-variant-numeric: tabular-nums;
        }
        
        .col-currency {
            width: 11%;
            text-align: right;
            font-variant-numeric: tabular-nums;
            font-family: ui-monospace, 'Cascadia Code', 'Roboto Mono', monospace;
        }
        
        .col-percentage {
            width: 8%;
            text-align: right;
            font-variant-numeric: tabular-nums;
            font-family: ui-monospace, 'Cascadia Code', 'Roboto Mono', monospace;
        }
        
        .col-multiple {
            width: 7%;
            text-align: right;
            font-variant-numeric: tabular-nums;
            font-family: ui-monospace, 'Cascadia Code', 'Roboto Mono', monospace;
        }
        
        .col-xnpv {
            width: 10%;
            text-align: right;
            font-variant-numeric: tabular-nums;
            font-family: ui-monospace, 'Cascadia Code', 'Roboto Mono', monospace;
        }
        
        .col-estimated {
            width: 11%;
            text-align: right;
            font-variant-numeric: tabular-nums;
            font-family: ui-monospace, 'Cascadia Code', 'Roboto Mono', monospace;
        }
        
        .print-button {
            text-align: center;
            margin: 20px 0;
        }
        
        .print-button button {
            padding: 10px 20px;
            font-size: 14px;
            background-color: #007cba;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .print-button button:hover {
            background-color: #005a87;
        }
        
        .print-footer {
            text-align: center;
            margin-top: 20px;
            font-size: 10px;
            color: #666;
        }
        
        /* üñ®Ô∏è LANDSCAPE –ü–ï–ß–ê–¢–¨ */
        @media print {
            /* –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø LANDSCAPE –û–†–ò–ï–ù–¢–ê–¶–ò–Ø */
            @page {
                size: A4 landscape; /* –ê–ª—å–±–æ–º–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è */
                margin: 0.5in; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–æ–ª—è */
            }
            
            .print-button {
                display: none;
            }
            
            body {
                margin: 0;
                padding: 10px;
                font-size: 12px;
            }
            
            h2 {
                margin-bottom: 15px;
                font-size: 18px;
                page-break-after: avoid;
            }
            
            table {
                font-size: 12px; /* –ö—Ä—É–ø–Ω–µ–µ —à—Ä–∏—Ñ—Ç –¥–ª—è –ø–µ—á–∞—Ç–∏ */
                width: 100%;
                page-break-inside: avoid;
            }
            
            th {
                font-size: 11px;
                background-color: #f0f0f0 !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
            
            th, td {
                padding: 6px 8px; /* –ë–æ–ª—å—à–µ –æ—Ç—Å—Ç—É–ø—ã –≤ –ø–µ—á–∞—Ç–∏ */
            }
            
            tbody tr:nth-child(even) {
                background-color: #f8f8f8 !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
            
            /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—ã –¥–ª—è landscape */
            .col-name {
                width: 15%;
            }
            
            .col-status {
                width: 8%;
            }
            
            .col-date {
                width: 10%;
            }
            
            .col-currency {
                width: 12%;
            }
            
            .col-percentage {
                width: 9%;
            }
            
            .col-multiple {
                width: 8%;
            }
            
            .col-xnpv {
                width: 11%;
            }
            
            .col-estimated {
                width: 12%;
            }
        }
    </style>
</head>
<body>
    <h2>üñ®Ô∏è Selected Projects Overview</h2>
    
    <table>
        <thead>
            <tr>
                <th class="col-name">Project Name</th>
                <th class="col-status">Status</th>
                <th class="col-date">Start Date</th>
                <th class="col-currency">Total Invested (USD)</th>
                <th class="col-currency">Total Returned (USD)</th>
                <th class="col-currency">NAV (USD)</th>
                <th class="col-percentage">XIRR (%)</th>
                <th class="col-multiple">DPI</th>
                <th class="col-multiple">TVPI</th>
                <th class="col-xnpv">XNPV (USD)</th>
                <th class="col-estimated">Est. Return (USD)</th>
            </tr>
        </thead>
        <tbody>
        {% for project in projects %}
            <tr>
                <td class="col-name">{{ project.name }}</td>
                <td class="col-status">{{ project.status|capfirst }}</td>
                <td class="col-date">
                    {% if project.start_date %}
                        {{ project.start_date|date:"M d, Y" }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td class="col-currency">{{ project.total_invested }}</td>
                <td class="col-currency">{{ project.total_returned }}</td>
                <td class="col-currency">{{ project.nav }}</td>
                <td class="col-percentage">{{ project.xirr }}</td>
                <td class="col-multiple">{{ project.dpi }}</td>
                <td class="col-multiple">{{ project.tvpi }}</td>
                <td class="col-xnpv">{{ project.xnpv }}</td>
                <td class="col-estimated">{{ project.estimated_return }}</td>
            </tr>
        {% empty %}
            <tr>
                <td colspan="11" style="text-align: center; font-style: italic; padding: 20px;">
                    No projects selected for printing.
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <div class="print-button">
        <button onclick="window.print()">üñ®Ô∏è Print This Report (Landscape)</button>
    </div>

    <div class="print-footer">
        <p>Generated on {% now "F d, Y \a\\t H:i" %}</p>
        <p><strong>Note:</strong> This report is optimized for landscape printing (A4 horizontal)</p>
    </div>
</body>
</html>